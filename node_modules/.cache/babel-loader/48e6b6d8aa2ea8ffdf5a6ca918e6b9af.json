{"ast":null,"code":"import socketIOClient from 'socket.io-client'; //import store from '../store/';\n\nimport { ENDPOINT } from '../constants/socket.types';\nimport { USER, LOBBY, ROOM, GAME, CHAT } from '../constants/';\nimport ACTION from '../actions';\n\nconst socketMiddleware = () => {\n  let io = null;\n\n  const onConnect = store => event => {\n    console.log('Howdy!');\n  };\n\n  const onDisconnect = store => event => {\n    console.log('Bowdy?');\n  };\n\n  const onMessage = dispatch => action => {\n    //TODO: I guess this is where we handle the server data\n    console.log('onMessage: ' + JSON.stringify(action));\n\n    switch (action.type) {\n      case USER.LOGIN:\n        dispatch({\n          type: ROOM.FETCH_ROOMS,\n          payload: action.payload.rooms\n        });\n        dispatch({\n          type: LOBBY.UPDATE,\n          payload: action.payload.rooms\n        });\n        dispatch({\n          type: USER.LOGIN,\n          payload: action.payload.me\n        });\n        break;\n\n      case ROOM.ENTER:\n        dispatch({\n          type: ROOM.FETCH_ROOMS,\n          payload: action.payload.rooms\n        });\n        break;\n\n      case ROOM.UPDATE_GAME:\n        dispatch(action);\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  return dispatch => action => {\n    switch (action.type) {\n      case 'connect':\n        if (io) break;\n        io = socketIOClient(action.host);\n        io.on('connect', onConnect(dispatch)).on('message', onMessage(dispatch)).on('disconnect', onDisconnect(dispatch));\n        break;\n\n      case 'disconnect':\n        if (io) io.close();\n        io = null;\n        console.log('Disconnected.');\n        break;\n\n      case USER.LOGIN:\n      case USER.LOGOUT:\n        io.emit('userEvent', action);\n        break;\n\n      case LOBBY.ADD_ROOM:\n      case LOBBY.REMOVE_ROOM:\n      case LOBBY.UPDATE:\n        io.emit('lobbyEvent', action);\n        break;\n\n      case ROOM.ENTER:\n      case ROOM.EXIT:\n      case ROOM.SUBMIT_MOVE:\n      case ROOM.END_GAME:\n        io.emit('roomEvent', action);\n        break;\n\n      case GAME.START:\n      case GAME.SELECT:\n      case GAME.END:\n        io.emit('gameEvent', action);\n        break;\n\n      default:\n        return dispatch(action);\n    }\n  };\n}; // function Socket () {\n//   this.io = socketIOClient.connect('ws://localhost:3001');\n//\n//   this.io\n//     .on('connect', () => console.log('howdy'))\n//     .on(LOBBY.UPDATE, (data) => store.dispatch(ACTION.LOBBY.update(data)))\n//     .on(LOBBY.ADD_ROOM, (data) => store.dispatch(ACTION.LOBBY.update(data)))\n//     .on('recieveMove', data => {\n//       console.log(data);\n//     });\n// }\n//\n// const socket = new Socket();\n\n\nexport default socketMiddleware;","map":{"version":3,"sources":["/Users/bacchus/git/Leap/client/src/middleware/socket.js"],"names":["socketIOClient","ENDPOINT","USER","LOBBY","ROOM","GAME","CHAT","ACTION","socketMiddleware","io","onConnect","store","event","console","log","onDisconnect","onMessage","dispatch","action","JSON","stringify","type","LOGIN","FETCH_ROOMS","payload","rooms","UPDATE","me","ENTER","UPDATE_GAME","host","on","close","LOGOUT","emit","ADD_ROOM","REMOVE_ROOM","EXIT","SUBMIT_MOVE","END_GAME","START","SELECT","END"],"mappings":"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","sourcesContent":["import socketIOClient from 'socket.io-client';\n//import store from '../store/';\nimport { ENDPOINT } from '../constants/socket.types';\nimport { USER, LOBBY, ROOM, GAME, CHAT } from '../constants/';\nimport ACTION from '../actions';\n\n\nconst socketMiddleware = () => {\n  let io = null;\n\n  const onConnect = store => event => {\n    console.log('Howdy!');\n  };\n\n  const onDisconnect = store => event => {\n    console.log('Bowdy?');\n  };\n\n  const onMessage = dispatch => action => {\n    //TODO: I guess this is where we handle the server data\n    console.log('onMessage: ' + JSON.stringify(action));\n    switch (action.type) {\n      case USER.LOGIN:\n\n        dispatch({type: ROOM.FETCH_ROOMS, payload: action.payload.rooms});\n        dispatch({type: LOBBY.UPDATE, payload: action.payload.rooms});\n        dispatch({type: USER.LOGIN, payload: action.payload.me});\n\n        break;\n\n      case ROOM.ENTER:\n        dispatch({type: ROOM.FETCH_ROOMS, payload: action.payload.rooms});\n        break;\n\n      case ROOM.UPDATE_GAME:\n        dispatch(action);\n        break;\n      default: break;\n    }\n  };\n\n  return dispatch => action => {\n    switch (action.type) {\n      case 'connect':\n        if (io) break;\n\n        io = socketIOClient(action.host);\n        io\n          .on('connect', onConnect(dispatch))\n          .on('message', onMessage(dispatch))\n          .on('disconnect', onDisconnect(dispatch));\n        break;\n\n      case 'disconnect':\n        if (io) io.close();\n        io = null;\n        console.log('Disconnected.');\n        break;\n\n      case USER.LOGIN:\n      case USER.LOGOUT:\n        io.emit('userEvent', action);\n        break;\n\n      case LOBBY.ADD_ROOM:\n      case LOBBY.REMOVE_ROOM:\n      case LOBBY.UPDATE:\n        io.emit('lobbyEvent', action);\n        break;\n\n      case ROOM.ENTER:\n      case ROOM.EXIT:\n      case ROOM.SUBMIT_MOVE:\n      case ROOM.END_GAME:\n        io.emit('roomEvent', action);\n        break;\n\n      case GAME.START:\n      case GAME.SELECT:\n      case GAME.END:\n        io.emit('gameEvent', action);\n        break;\n\n\n      default:\n      return dispatch(action);\n    }\n  };\n};\n\n// function Socket () {\n//   this.io = socketIOClient.connect('ws://localhost:3001');\n//\n//   this.io\n//     .on('connect', () => console.log('howdy'))\n//     .on(LOBBY.UPDATE, (data) => store.dispatch(ACTION.LOBBY.update(data)))\n//     .on(LOBBY.ADD_ROOM, (data) => store.dispatch(ACTION.LOBBY.update(data)))\n//     .on('recieveMove', data => {\n//       console.log(data);\n//     });\n// }\n//\n// const socket = new Socket();\n\nexport default socketMiddleware;\n"]},"metadata":{},"sourceType":"module"}