{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : new P(function (resolve) {\n        resolve(result.value);\n      }).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n  result[\"default\"] = mod;\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar http = __importStar(require(\"httpie\"));\n\nvar Storage_1 = require(\"./Storage\");\n\nvar TOKEN_STORAGE = \"colyseus-auth-token\";\nvar Platform;\n\n(function (Platform) {\n  Platform[\"ios\"] = \"ios\";\n  Platform[\"android\"] = \"android\";\n})(Platform = exports.Platform || (exports.Platform = {}));\n\nvar Auth =\n/** @class */\nfunction () {\n  function Auth(endpoint) {\n    var _this = this;\n\n    this._id = undefined;\n    this.username = undefined;\n    this.displayName = undefined;\n    this.avatarUrl = undefined;\n    this.isAnonymous = undefined;\n    this.email = undefined;\n    this.lang = undefined;\n    this.location = undefined;\n    this.timezone = undefined;\n    this.metadata = undefined;\n    this.devices = undefined;\n    this.facebookId = undefined;\n    this.twitterId = undefined;\n    this.googleId = undefined;\n    this.gameCenterId = undefined;\n    this.steamId = undefined;\n    this.friendIds = undefined;\n    this.blockedUserIds = undefined;\n    this.createdAt = undefined;\n    this.updatedAt = undefined; // auth token\n\n    this.token = undefined;\n    this.endpoint = endpoint.replace(\"ws\", \"http\");\n    Storage_1.getItem(TOKEN_STORAGE, function (token) {\n      return _this.token = token;\n    });\n  }\n\n  Object.defineProperty(Auth.prototype, \"hasToken\", {\n    get: function () {\n      return !!this.token;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Auth.prototype.login = function (options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    return __awaiter(this, void 0, void 0, function () {\n      var queryParams, data, attr;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            queryParams = Object.assign({}, options);\n\n            if (this.hasToken) {\n              queryParams.token = this.token;\n            }\n\n            return [4\n            /*yield*/\n            , this.request('post', '/auth', queryParams)];\n\n          case 1:\n            data = _a.sent(); // set & cache token\n\n            this.token = data.token;\n            Storage_1.setItem(TOKEN_STORAGE, this.token);\n\n            for (attr in data) {\n              if (this.hasOwnProperty(attr)) {\n                this[attr] = data[attr];\n              }\n            }\n\n            this.registerPingService();\n            return [2\n            /*return*/\n            , this];\n        }\n      });\n    });\n  };\n\n  Auth.prototype.save = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this.request('put', '/auth', {}, {\n              username: this.username,\n              displayName: this.displayName,\n              avatarUrl: this.avatarUrl,\n              lang: this.lang,\n              location: this.location,\n              timezone: this.timezone\n            })];\n\n          case 1:\n            _a.sent();\n\n            return [2\n            /*return*/\n            , this];\n        }\n      });\n    });\n  };\n\n  Auth.prototype.getFriends = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this.request('get', '/friends/all')];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  };\n\n  Auth.prototype.getOnlineFriends = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this.request('get', '/friends/online')];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  };\n\n  Auth.prototype.getFriendRequests = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this.request('get', '/friends/requests')];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  };\n\n  Auth.prototype.sendFriendRequest = function (friendId) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this.request('post', '/friends/requests', {\n              userId: friendId\n            })];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  };\n\n  Auth.prototype.acceptFriendRequest = function (friendId) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this.request('put', '/friends/requests', {\n              userId: friendId\n            })];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  };\n\n  Auth.prototype.declineFriendRequest = function (friendId) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this.request('del', '/friends/requests', {\n              userId: friendId\n            })];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  };\n\n  Auth.prototype.blockUser = function (friendId) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this.request('post', '/friends/block', {\n              userId: friendId\n            })];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  };\n\n  Auth.prototype.unblockUser = function (friendId) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this.request('put', '/friends/block', {\n              userId: friendId\n            })];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  };\n\n  Auth.prototype.request = function (method, segments, query, body, headers) {\n    if (query === void 0) {\n      query = {};\n    }\n\n    if (headers === void 0) {\n      headers = {};\n    }\n\n    return __awaiter(this, void 0, void 0, function () {\n      var queryParams, name_1, queryString, opts;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            headers['Accept'] = 'application/json';\n\n            if (this.hasToken) {\n              headers['Authorization'] = 'Bearer ' + this.token;\n            }\n\n            queryParams = [];\n\n            for (name_1 in query) {\n              queryParams.push(name_1 + \"=\" + query[name_1]);\n            }\n\n            queryString = queryParams.length > 0 ? \"?\" + queryParams.join(\"&\") : '';\n            opts = {\n              headers: headers\n            };\n\n            if (body) {\n              opts.body = body;\n            }\n\n            return [4\n            /*yield*/\n            , http[method](\"\" + this.endpoint + segments + queryString, opts)];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent().data];\n        }\n      });\n    });\n  };\n\n  Auth.prototype.logout = function () {\n    this.token = undefined;\n    Storage_1.removeItem(TOKEN_STORAGE);\n    this.unregisterPingService();\n  };\n\n  Auth.prototype.registerPingService = function (timeout) {\n    var _this = this;\n\n    if (timeout === void 0) {\n      timeout = 15000;\n    }\n\n    this.unregisterPingService();\n    this.keepOnlineInterval = setInterval(function () {\n      return _this.request('get', '/auth');\n    }, timeout);\n  };\n\n  Auth.prototype.unregisterPingService = function () {\n    clearInterval(this.keepOnlineInterval);\n  };\n\n  return Auth;\n}();\n\nexports.Auth = Auth;","map":{"version":3,"sources":["/Users/bacchus/git/Leap/node_modules/colyseus.js/lib/Auth.js"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","__importStar","mod","__esModule","k","Object","hasOwnProperty","defineProperty","exports","http","require","Storage_1","TOKEN_STORAGE","Platform","Auth","endpoint","_this","_id","undefined","username","displayName","avatarUrl","isAnonymous","email","lang","location","timezone","metadata","devices","facebookId","twitterId","googleId","gameCenterId","steamId","friendIds","blockedUserIds","createdAt","updatedAt","token","replace","getItem","prototype","get","enumerable","configurable","login","options","queryParams","data","attr","_a","assign","hasToken","request","setItem","registerPingService","save","getFriends","getOnlineFriends","getFriendRequests","sendFriendRequest","friendId","userId","acceptFriendRequest","declineFriendRequest","blockUser","unblockUser","method","segments","query","headers","name_1","queryString","opts","join","logout","removeItem","unregisterPingService","timeout","keepOnlineInterval","setInterval","clearInterval"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar http = __importStar(require(\"httpie\"));\nvar Storage_1 = require(\"./Storage\");\nvar TOKEN_STORAGE = \"colyseus-auth-token\";\nvar Platform;\n(function (Platform) {\n    Platform[\"ios\"] = \"ios\";\n    Platform[\"android\"] = \"android\";\n})(Platform = exports.Platform || (exports.Platform = {}));\nvar Auth = /** @class */ (function () {\n    function Auth(endpoint) {\n        var _this = this;\n        this._id = undefined;\n        this.username = undefined;\n        this.displayName = undefined;\n        this.avatarUrl = undefined;\n        this.isAnonymous = undefined;\n        this.email = undefined;\n        this.lang = undefined;\n        this.location = undefined;\n        this.timezone = undefined;\n        this.metadata = undefined;\n        this.devices = undefined;\n        this.facebookId = undefined;\n        this.twitterId = undefined;\n        this.googleId = undefined;\n        this.gameCenterId = undefined;\n        this.steamId = undefined;\n        this.friendIds = undefined;\n        this.blockedUserIds = undefined;\n        this.createdAt = undefined;\n        this.updatedAt = undefined;\n        // auth token\n        this.token = undefined;\n        this.endpoint = endpoint.replace(\"ws\", \"http\");\n        Storage_1.getItem(TOKEN_STORAGE, function (token) { return _this.token = token; });\n    }\n    Object.defineProperty(Auth.prototype, \"hasToken\", {\n        get: function () {\n            return !!this.token;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Auth.prototype.login = function (options) {\n        if (options === void 0) { options = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            var queryParams, data, attr;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        queryParams = Object.assign({}, options);\n                        if (this.hasToken) {\n                            queryParams.token = this.token;\n                        }\n                        return [4 /*yield*/, this.request('post', '/auth', queryParams)];\n                    case 1:\n                        data = _a.sent();\n                        // set & cache token\n                        this.token = data.token;\n                        Storage_1.setItem(TOKEN_STORAGE, this.token);\n                        for (attr in data) {\n                            if (this.hasOwnProperty(attr)) {\n                                this[attr] = data[attr];\n                            }\n                        }\n                        this.registerPingService();\n                        return [2 /*return*/, this];\n                }\n            });\n        });\n    };\n    Auth.prototype.save = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('put', '/auth', {}, {\n                            username: this.username,\n                            displayName: this.displayName,\n                            avatarUrl: this.avatarUrl,\n                            lang: this.lang,\n                            location: this.location,\n                            timezone: this.timezone,\n                        })];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/, this];\n                }\n            });\n        });\n    };\n    Auth.prototype.getFriends = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('get', '/friends/all')];\n                    case 1: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    Auth.prototype.getOnlineFriends = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('get', '/friends/online')];\n                    case 1: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    Auth.prototype.getFriendRequests = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('get', '/friends/requests')];\n                    case 1: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    Auth.prototype.sendFriendRequest = function (friendId) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('post', '/friends/requests', { userId: friendId })];\n                    case 1: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    Auth.prototype.acceptFriendRequest = function (friendId) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('put', '/friends/requests', { userId: friendId })];\n                    case 1: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    Auth.prototype.declineFriendRequest = function (friendId) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('del', '/friends/requests', { userId: friendId })];\n                    case 1: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    Auth.prototype.blockUser = function (friendId) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('post', '/friends/block', { userId: friendId })];\n                    case 1: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    Auth.prototype.unblockUser = function (friendId) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('put', '/friends/block', { userId: friendId })];\n                    case 1: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    Auth.prototype.request = function (method, segments, query, body, headers) {\n        if (query === void 0) { query = {}; }\n        if (headers === void 0) { headers = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            var queryParams, name_1, queryString, opts;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        headers['Accept'] = 'application/json';\n                        if (this.hasToken) {\n                            headers['Authorization'] = 'Bearer ' + this.token;\n                        }\n                        queryParams = [];\n                        for (name_1 in query) {\n                            queryParams.push(name_1 + \"=\" + query[name_1]);\n                        }\n                        queryString = (queryParams.length > 0)\n                            ? \"?\" + queryParams.join(\"&\")\n                            : '';\n                        opts = { headers: headers };\n                        if (body) {\n                            opts.body = body;\n                        }\n                        return [4 /*yield*/, http[method](\"\" + this.endpoint + segments + queryString, opts)];\n                    case 1: return [2 /*return*/, (_a.sent()).data];\n                }\n            });\n        });\n    };\n    Auth.prototype.logout = function () {\n        this.token = undefined;\n        Storage_1.removeItem(TOKEN_STORAGE);\n        this.unregisterPingService();\n    };\n    Auth.prototype.registerPingService = function (timeout) {\n        var _this = this;\n        if (timeout === void 0) { timeout = 15000; }\n        this.unregisterPingService();\n        this.keepOnlineInterval = setInterval(function () { return _this.request('get', '/auth'); }, timeout);\n    };\n    Auth.prototype.unregisterPingService = function () {\n        clearInterval(this.keepOnlineInterval);\n    };\n    return Auth;\n}());\nexports.Auth = Auth;\n"]},"metadata":{},"sourceType":"script"}