{"ast":null,"code":"var _jsxFileName = \"/Users/bacchus/git/Leap/client/src/components/Game/Game.js\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { select, moveReady, cacheMove } from '../../actions/game.actions';\nimport { bindActionCreators } from 'redux';\nimport Leap from '../../assets/leap';\nimport './Game.css';\nimport Cell from '../Cell';\nexport class Game extends React.Component {\n  constructor({\n    game,\n    player,\n    move,\n    cacheMove,\n    moveReady\n  }) {\n    super();\n    this.state = {\n      game: game,\n      player: player,\n      move: move,\n      continuedMove: false\n    };\n  }\n\n  componentDidMount() {\n    const _this$state = this.state,\n          game = _this$state.game,\n          player = _this$state.player;\n\n    if (game.turn === player) {\n      if (!game.getAllMoves(game.turn)) {\n        console.log(`${game.turn} has no more moves!`);\n        this.endTurn(true);\n      }\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const _this$state2 = this.state,\n          game = _this$state2.game,\n          player = _this$state2.player;\n\n    if (game.turn === player) {\n      if (!game.getAllMoves(game.turn)) {\n        console.log(`${game.turn} has no more moves!`);\n        this.endTurn(true);\n      }\n    }\n  }\n\n  selectCell(cell, index) {\n    //call implies it's this user's turn\n    const _this$state3 = this.state,\n          game = _this$state3.game,\n          player = _this$state3.player;\n    const highlighted = cell & 2;\n\n    if (game.continuedMove) {\n      //implies current user is moving\n      if (highlighted) this.setDestination(index);else {\n        //TODO: prompt \"end turn?\" option\n        game.switchPlayer(); //sketchy\n\n        this.endTurn();\n      }\n    } else {\n      const pieceType = cell & (4 | 8 | 12);\n\n      if (pieceType) {\n        //if piece\n        const canSelectPiece = !(pieceType ^ player) || pieceType === 10;\n        const hasMoves = game.moves[cell >> 5].length > 0;\n        if (canSelectPiece && hasMoves) this.setPiece(cell, index);else try {\n          if (!canSelectPiece) throw 'OPPONENT PIECE';\n          if (!hasMoves) throw 'PIECE HAS NO MOVES';\n        } catch (error) {\n          console.log(`CANNOT SELECT: ${error}`);\n        }\n      } else {\n        //if empty cell\n        if (cell & 2) this.setDestination(index);else console.log('CANNOT SELECT: NOT EMPTY');\n      }\n    }\n  }\n\n  setPiece(cell, index) {\n    const game = this.state.game;\n    const pi = cell >> 5;\n    game.removeHighlight();\n    game.highlightMoves(pi);\n    const move = {\n      from: index,\n      to: undefined,\n      captured: undefined\n    };\n    this.setState({\n      move: move\n    });\n    cacheMove(move);\n  }\n\n  setDestination(to) {\n    this.setState({\n      move: {\n        from: this.state.move.from,\n        to: to,\n        captured: this.state.game.getCapturedPiece(to)\n      }\n    });\n    moveReady();\n  }\n  /*\n  move() {\n    const { game, move } = this.state;\n    const { from, to } = move;\n    const pi = game.board[from] >> 5;\n  \n    if (game.doMove(from, to)) { //win\n      this.endTurn(true);\n      return;\n    } else if (game.continuedMove) {\n      game.highlightMoves(pi);\n      this.setState({ game: game, move: {to: to, from: undefined, captured: undefined} });\n    } else {\n      this.endTurn();\n    }\n  }\n  */\n\n\n  render() {\n    const _this$state4 = this.state,\n          game = _this$state4.game,\n          move = _this$state4.move;\n\n    const _game$getConfig = game.getConfig(),\n          BOARD_AREA = _game$getConfig.BOARD_AREA;\n    /*  display: grid for the cells  */\n\n\n    let cells = [];\n\n    for (let index = 0; index < BOARD_AREA; index++) {\n      const cell = game.board[index];\n      const moveType = move.to === index && 'to' || move.from === index && 'from' || move.captured === index && 'captured' || '';\n      cells.push(React.createElement(Cell, {\n        key: index,\n        index: index,\n        cell: cell,\n        highlight: cell & 2,\n        moveType: moveType,\n        select: this.selectCell.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }));\n    }\n\n    return React.createElement(\"div\", {\n      className: \"board\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, \" \", cells, \" \");\n  }\n\n}\nGame.propTypes = {\n  game: object.isRequired,\n  player: number.isRequired ///move: object\n\n};\n\nconst mapStateToProps = state => ({\n  player: getUserPlaymode(state) //move: getMoveSelections(state)\n\n});\n\nconst actions = {\n  cacheMove,\n  moveReady\n};\nexport default connect(mapStateToProps, dispatch => bindActionCreators({\n  moveReady\n}, dispatch))(Game);","map":{"version":3,"sources":["/Users/bacchus/git/Leap/client/src/components/Game/Game.js"],"names":["React","connect","select","moveReady","cacheMove","bindActionCreators","Leap","Cell","Game","Component","constructor","game","player","move","state","continuedMove","componentDidMount","turn","getAllMoves","console","log","endTurn","componentDidUpdate","prevProps","prevState","selectCell","cell","index","highlighted","setDestination","switchPlayer","pieceType","canSelectPiece","hasMoves","moves","length","setPiece","error","pi","removeHighlight","highlightMoves","from","to","undefined","captured","setState","getCapturedPiece","render","getConfig","BOARD_AREA","cells","board","moveType","push","bind","propTypes","object","isRequired","number","mapStateToProps","getUserPlaymode","actions","dispatch"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport { select, moveReady, cacheMove } from '../../actions/game.actions';\nimport { bindActionCreators } from 'redux';\nimport Leap from '../../assets/leap';\nimport './Game.css';\nimport Cell from '../Cell';\n\nexport class Game extends React.Component {\n  constructor ({ game, player, move, cacheMove, moveReady}) {\n    super();\n    this.state = {\n      game: game,\n      player: player,\n      move: move,\n      continuedMove: false,\n    }\n  }\n\n  componentDidMount () {\n    const { game, player } = this.state;\n    if (game.turn === player) {\n      if (!game.getAllMoves(game.turn)) {\n        console.log(`${game.turn} has no more moves!`);\n        this.endTurn(true);\n      }\n    }\n  }\n\n  componentDidUpdate (prevProps, prevState) {\n    const { game, player } = this.state;\n    if (game.turn === player) {\n      if (!game.getAllMoves(game.turn)) {\n        console.log(`${game.turn} has no more moves!`);\n        this.endTurn(true);\n      }\n    }\n  }\n\n  selectCell (cell, index) { //call implies it's this user's turn\n    const { game, player } = this.state;\n    const highlighted = (cell & 2);\n\n    if (game.continuedMove) { //implies current user is moving\n      if (highlighted) this.setDestination(index);\n      else {\n        //TODO: prompt \"end turn?\" option\n        game.switchPlayer(); //sketchy\n        this.endTurn();\n      }\n    } else {\n      const pieceType = cell & (4 | 8 | 12);\n      if (pieceType) {  //if piece\n        const canSelectPiece = !(pieceType ^ player) || pieceType === 10;\n        const hasMoves = game.moves[cell >> 5].length > 0;\n\n        if (canSelectPiece && hasMoves) this.setPiece(cell, index);\n        else try {\n          if (!canSelectPiece) throw 'OPPONENT PIECE';\n          if (!hasMoves) throw 'PIECE HAS NO MOVES';\n        } catch (error) {\n          console.log(`CANNOT SELECT: ${error}`);\n        }\n      }\n      else {  //if empty cell\n        if (cell & 2) this.setDestination(index);\n        else console.log('CANNOT SELECT: NOT EMPTY');\n      }\n  }\n}\n\nsetPiece (cell, index) {\n  const { game } = this.state;\n  const pi = cell >> 5;\n  game.removeHighlight();\n  game.highlightMoves(pi);\n  const move = {from: index, to: undefined, captured: undefined};\n  this.setState({ move: move });\n  cacheMove(move);\n}\n\nsetDestination (to) {\n  this.setState({ move: {from: this.state.move.from, to: to, captured: this.state.game.getCapturedPiece(to)} });\n  moveReady();\n}\n/*\nmove() {\n  const { game, move } = this.state;\n  const { from, to } = move;\n  const pi = game.board[from] >> 5;\n\n  if (game.doMove(from, to)) { //win\n    this.endTurn(true);\n    return;\n  } else if (game.continuedMove) {\n    game.highlightMoves(pi);\n    this.setState({ game: game, move: {to: to, from: undefined, captured: undefined} });\n  } else {\n    this.endTurn();\n  }\n}\n*/\n\nrender () {\n  const { game, move } = this.state;\n  const { BOARD_AREA } = game.getConfig();\n  /*  display: grid for the cells  */\n  let cells = [];\n  for (let index = 0; index < BOARD_AREA; index++) {\n    const cell = game.board[index];\n    const moveType = (move.to === index && 'to')\n     || (move.from === index && 'from')\n     || (move.captured === index && 'captured')\n     || '';\n\n    cells.push(<Cell\n      key={index}\n      index={index}\n      cell={cell}\n      highlight={cell & 2}\n      moveType={moveType}\n      select={this.selectCell.bind(this)} />);\n  }\n  return (<div className=\"board\"> { cells } </div>);\n};\n\n}\n\nGame.propTypes = {\n  game: object.isRequired,\n  player: number.isRequired,\n  ///move: object\n};\n\nconst mapStateToProps = state => ({\n  player: getUserPlaymode(state),\n  //move: getMoveSelections(state)\n});\n\nconst actions = {\n  cacheMove,\n  moveReady,\n};\n\nexport default connect(mapStateToProps, dispatch => bindActionCreators({moveReady},dispatch))(Game);\n"]},"metadata":{},"sourceType":"module"}